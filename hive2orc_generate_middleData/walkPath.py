#coding:utf-8

import os

def dirlist(path, allfile):
    filelist =  os.listdir(path)

    for filename in filelist:
        filepath = os.path.join(path, filename)
        if os.path.isdir(filepath):
            dirlist(filepath, allfile)
        else:
            if 'csv' in filepath:
                allfile.append(filepath)
    return allfile

#allcsv = dirlist("/home/data/hd", [])    
#allcsv = dirlist("/home/data/hd_ffz_mean", [])    
allcsv = dirlist("/home/data/hd_all_xfs_ffzmean", [])    

for c in allcsv:
    ymdh = c.split('.')[0].split('/')[-1]
    #hadoop fs -put /home/data/hd24/20170506/2017050600.csv /user/root/hd24/ y=2017/m=05/d=06/h=00
    #print 'hadoop fs -put ' + c + ' /user/root/hd_premiddledata_ffz_mean/y='+ymdh[:4]+'/m='+ymdh[4:6]+'/d='+ymdh[6:8] 
    print 'hadoop fs -put ' + c + ' /user/root/hd_middledata_all_xfs_ffz_mean/y='+ymdh[:4]+'/m='+ymdh[4:6]+'/d='+ymdh[6:8] 

    #sa = "alter table hd_premiddledata_ffz_mean_tmp add partition(y='"+ymdh[:4]+"',m='"+ymdh[4:6]+"',d='"+ymdh[6:8]+"');"
    #sa = "alter table hd_middledata_all_xfs_ffz_mean_tmp add partition(y='"+ymdh[:4]+"',m='"+ymdh[4:6]+"',d='"+ymdh[6:8]+"');"
    #print sa
    #cat /home/data/hd/20170506/2017050600.csv | /usr/bin/python /home/zd/hive2orc_generate_middleData/ffz_mean_middleData.py  >> /home/data/hd_ffz_mean/20170506.csv
    # 
    #print 'cat ' + c + ' | /usr/bin/python /home/zd/hive2orc_generate_middleData/ffz_mean_middleData.py >> /home/data/hd_ffz_mean/' + c[14:22] + '.csv'
    #print 'cat ' + c + ' | /usr/bin/python /home/zd/hive2orc_generate_middleData/all_xfs_middleData.py >> /home/data/hd_all_xfs_ffzmean/' + c[14:22] + '.csv'

    #si = "insert overwrite table hd_premiddledata_ffz_mean_ext_orc partition(y='"+ymdh[:4]+"',m='"+ymdh[4:6]+"',d='"+ymdh[6:8]+"') select gettime,shangx_ffz,shangy_ffz,xiax_ffz,xiay_ffz,shuix_ffz,shuiy_ffz,shangjjx_ffz,shangjjy_ffz,shangjjz_ffz,dingjjx_ffz,dingjjy_ffz,xiajjx_ffz,xiajjy_ffz,xiajjz_ffz,dinggx_ffz,dinggy_ffz,dinggz_ffz,dingzh1_ffz,dingzh2_ffz,dingzh3_ffz,dingzv1_ffz,dingzv2_ffz,dingzv3_ffz,ylmddg_ffz,ylmdwy_ffz,ylmdwk_ffz,ylmdshang_ffz,ylmdxia_ffz,wkyc_mv,bqfs_mv,active_power_mv,reactive_power_mv,vane_open_mv,backup_mv,waterhead_mv,exc_current_mv,exc_voltage_mv,zs_mv,flow_mv from hd_premiddledata_ffz_mean_tmp where y='"+ymdh[:4]+"' and m='"+ymdh[4:6]+"' and d='"+ymdh[6:8]+"';"
    #print si

    #si = "insert overwrite table hd_middledata_all_xfs_ffz_mean_ext_orc partition(y='"+ymdh[:4]+"',m='"+ymdh[4:6]+"',d='"+ymdh[6:8]+"') select gettime,shangx_ffzmin,shangx_ffzmax,shangx_ffzmean,shangx_xf1_4,shangx_xf1_3,shangx_xf1_2,shangx_xf1,shangx_xf3_2,shangx_xf2,shangx_xf5_2,shangx_xf3,shangx_xf7_2,shangx_xf4,shangx_xf9_2,shangx_xf5,shangx_xf11_2,shangx_xf6,shangx_xf13_2,shangx_xf7,shangx_xf15_2,shangx_xf8,shangx_xf17_2,shangx_xf9,shangx_xf19_2,shangx_xf10,shangy_ffzmin,shangy_ffzmax,shangy_ffzmean,shangy_xf1_4,shangy_xf1_3,shangy_xf1_2,shangy_xf1,shangy_xf3_2,shangy_xf2,shangy_xf5_2,shangy_xf3,shangy_xf7_2,shangy_xf4,shangy_xf9_2,shangy_xf5,shangy_xf11_2,shangy_xf6,shangy_xf13_2,shangy_xf7,shangy_xf15_2,shangy_xf8,shangy_xf17_2,shangy_xf9,shangy_xf19_2,shangy_xf10,xiax_ffzmin,xiax_ffzmax,xiax_ffzmean,xiax_xf1_4,xiax_xf1_3,xiax_xf1_2,xiax_xf1,xiax_xf3_2,xiax_xf2,xiax_xf5_2,xiax_xf3,xiax_xf7_2,xiax_xf4,xiax_xf9_2,xiax_xf5,xiax_xf11_2,xiax_xf6,xiax_xf13_2,xiax_xf7,xiax_xf15_2,xiax_xf8,xiax_xf17_2,xiax_xf9,xiax_xf19_2,xiax_xf10,xiay_ffzmin,xiay_ffzmax,xiay_ffzmean,xiay_xf1_4,xiay_xf1_3,xiay_xf1_2,xiay_xf1,xiay_xf3_2,xiay_xf2,xiay_xf5_2,xiay_xf3,xiay_xf7_2,xiay_xf4,xiay_xf9_2,xiay_xf5,xiay_xf11_2,xiay_xf6,xiay_xf13_2,xiay_xf7,xiay_xf15_2,xiay_xf8,xiay_xf17_2,xiay_xf9,xiay_xf19_2,xiay_xf10,shuix_ffzmin,shuix_ffzmax,shuix_ffzmean,shuix_xf1_4,shuix_xf1_3,shuix_xf1_2,shuix_xf1,shuix_xf3_2,shuix_xf2,shuix_xf5_2,shuix_xf3,shuix_xf7_2,shuix_xf4,shuix_xf9_2,shuix_xf5,shuix_xf11_2,shuix_xf6,shuix_xf13_2,shuix_xf7,shuix_xf15_2,shuix_xf8,shuix_xf17_2,shuix_xf9,shuix_xf19_2,shuix_xf10,shuiy_ffzmin,shuiy_ffzmax,shuiy_ffzmean,shuiy_xf1_4,shuiy_xf1_3,shuiy_xf1_2,shuiy_xf1,shuiy_xf3_2,shuiy_xf2,shuiy_xf5_2,shuiy_xf3,shuiy_xf7_2,shuiy_xf4,shuiy_xf9_2,shuiy_xf5,shuiy_xf11_2,shuiy_xf6,shuiy_xf13_2,shuiy_xf7,shuiy_xf15_2,shuiy_xf8,shuiy_xf17_2,shuiy_xf9,shuiy_xf19_2,shuiy_xf10,shangjjx_ffzmin,shangjjx_ffzmax,shangjjx_ffzmean,shangjjx_xf1_4,shangjjx_xf1_3,shangjjx_xf1_2,shangjjx_xf1,shangjjx_xf3_2,shangjjx_xf2,shangjjx_xf5_2,shangjjx_xf3,shangjjx_xf7_2,shangjjx_xf4,shangjjx_xf9_2,shangjjx_xf5,shangjjx_xf11_2,shangjjx_xf6,shangjjx_xf13_2,shangjjx_xf7,shangjjx_xf15_2,shangjjx_xf8,shangjjx_xf17_2,shangjjx_xf9,shangjjx_xf19_2,shangjjx_xf10,shangjjy_ffzmin,shangjjy_ffzmax,shangjjy_ffzmean,shangjjy_xf1_4,shangjjy_xf1_3,shangjjy_xf1_2,shangjjy_xf1,shangjjy_xf3_2,shangjjy_xf2,shangjjy_xf5_2,shangjjy_xf3,shangjjy_xf7_2,shangjjy_xf4,shangjjy_xf9_2,shangjjy_xf5,shangjjy_xf11_2,shangjjy_xf6,shangjjy_xf13_2,shangjjy_xf7,shangjjy_xf15_2,shangjjy_xf8,shangjjy_xf17_2,shangjjy_xf9,shangjjy_xf19_2,shangjjy_xf10,shangjjz_ffzmin,shangjjz_ffzmax,shangjjz_ffzmean,shangjjz_xf1_4,shangjjz_xf1_3,shangjjz_xf1_2,shangjjz_xf1,shangjjz_xf3_2,shangjjz_xf2,shangjjz_xf5_2,shangjjz_xf3,shangjjz_xf7_2,shangjjz_xf4,shangjjz_xf9_2,shangjjz_xf5,shangjjz_xf11_2,shangjjz_xf6,shangjjz_xf13_2,shangjjz_xf7,shangjjz_xf15_2,shangjjz_xf8,shangjjz_xf17_2,shangjjz_xf9,shangjjz_xf19_2,shangjjz_xf10,dingjjx_ffzmin,dingjjx_ffzmax,dingjjx_ffzmean,dingjjx_xf1_4,dingjjx_xf1_3,dingjjx_xf1_2,dingjjx_xf1,dingjjx_xf3_2,dingjjx_xf2,dingjjx_xf5_2,dingjjx_xf3,dingjjx_xf7_2,dingjjx_xf4,dingjjx_xf9_2,dingjjx_xf5,dingjjx_xf11_2,dingjjx_xf6,dingjjx_xf13_2,dingjjx_xf7,dingjjx_xf15_2,dingjjx_xf8,dingjjx_xf17_2,dingjjx_xf9,dingjjx_xf19_2,dingjjx_xf10,dingjjy_ffzmin,dingjjy_ffzmax,dingjjy_ffzmean,dingjjy_xf1_4,dingjjy_xf1_3,dingjjy_xf1_2,dingjjy_xf1,dingjjy_xf3_2,dingjjy_xf2,dingjjy_xf5_2,dingjjy_xf3,dingjjy_xf7_2,dingjjy_xf4,dingjjy_xf9_2,dingjjy_xf5,dingjjy_xf11_2,dingjjy_xf6,dingjjy_xf13_2,dingjjy_xf7,dingjjy_xf15_2,dingjjy_xf8,dingjjy_xf17_2,dingjjy_xf9,dingjjy_xf19_2,dingjjy_xf10,xiajjx_ffzmin,xiajjx_ffzmax,xiajjx_ffzmean,xiajjx_xf1_4,xiajjx_xf1_3,xiajjx_xf1_2,xiajjx_xf1,xiajjx_xf3_2,xiajjx_xf2,xiajjx_xf5_2,xiajjx_xf3,xiajjx_xf7_2,xiajjx_xf4,xiajjx_xf9_2,xiajjx_xf5,xiajjx_xf11_2,xiajjx_xf6,xiajjx_xf13_2,xiajjx_xf7,xiajjx_xf15_2,xiajjx_xf8,xiajjx_xf17_2,xiajjx_xf9,xiajjx_xf19_2,xiajjx_xf10,xiajjy_ffzmin,xiajjy_ffzmax,xiajjy_ffzmean,xiajjy_xf1_4,xiajjy_xf1_3,xiajjy_xf1_2,xiajjy_xf1,xiajjy_xf3_2,xiajjy_xf2,xiajjy_xf5_2,xiajjy_xf3,xiajjy_xf7_2,xiajjy_xf4,xiajjy_xf9_2,xiajjy_xf5,xiajjy_xf11_2,xiajjy_xf6,xiajjy_xf13_2,xiajjy_xf7,xiajjy_xf15_2,xiajjy_xf8,xiajjy_xf17_2,xiajjy_xf9,xiajjy_xf19_2,xiajjy_xf10,xiajjz_ffzmin,xiajjz_ffzmax,xiajjz_ffzmean,xiajjz_xf1_4,xiajjz_xf1_3,xiajjz_xf1_2,xiajjz_xf1,xiajjz_xf3_2,xiajjz_xf2,xiajjz_xf5_2,xiajjz_xf3,xiajjz_xf7_2,xiajjz_xf4,xiajjz_xf9_2,xiajjz_xf5,xiajjz_xf11_2,xiajjz_xf6,xiajjz_xf13_2,xiajjz_xf7,xiajjz_xf15_2,xiajjz_xf8,xiajjz_xf17_2,xiajjz_xf9,xiajjz_xf19_2,xiajjz_xf10,dinggx_ffzmin,dinggx_ffzmax,dinggx_ffzmean,dinggx_xf1_4,dinggx_xf1_3,dinggx_xf1_2,dinggx_xf1,dinggx_xf3_2,dinggx_xf2,dinggx_xf5_2,dinggx_xf3,dinggx_xf7_2,dinggx_xf4,dinggx_xf9_2,dinggx_xf5,dinggx_xf11_2,dinggx_xf6,dinggx_xf13_2,dinggx_xf7,dinggx_xf15_2,dinggx_xf8,dinggx_xf17_2,dinggx_xf9,dinggx_xf19_2,dinggx_xf10,dinggy_ffzmin,dinggy_ffzmax,dinggy_ffzmean,dinggy_xf1_4,dinggy_xf1_3,dinggy_xf1_2,dinggy_xf1,dinggy_xf3_2,dinggy_xf2,dinggy_xf5_2,dinggy_xf3,dinggy_xf7_2,dinggy_xf4,dinggy_xf9_2,dinggy_xf5,dinggy_xf11_2,dinggy_xf6,dinggy_xf13_2,dinggy_xf7,dinggy_xf15_2,dinggy_xf8,dinggy_xf17_2,dinggy_xf9,dinggy_xf19_2,dinggy_xf10,dinggz_ffzmin,dinggz_ffzmax,dinggz_ffzmean,dinggz_xf1_4,dinggz_xf1_3,dinggz_xf1_2,dinggz_xf1,dinggz_xf3_2,dinggz_xf2,dinggz_xf5_2,dinggz_xf3,dinggz_xf7_2,dinggz_xf4,dinggz_xf9_2,dinggz_xf5,dinggz_xf11_2,dinggz_xf6,dinggz_xf13_2,dinggz_xf7,dinggz_xf15_2,dinggz_xf8,dinggz_xf17_2,dinggz_xf9,dinggz_xf19_2,dinggz_xf10,dingzh1_ffzmin,dingzh1_ffzmax,dingzh1_ffzmean,dingzh1_xf1_4,dingzh1_xf1_3,dingzh1_xf1_2,dingzh1_xf1,dingzh1_xf3_2,dingzh1_xf2,dingzh1_xf5_2,dingzh1_xf3,dingzh1_xf7_2,dingzh1_xf4,dingzh1_xf9_2,dingzh1_xf5,dingzh1_xf11_2,dingzh1_xf6,dingzh1_xf13_2,dingzh1_xf7,dingzh1_xf15_2,dingzh1_xf8,dingzh1_xf17_2,dingzh1_xf9,dingzh1_xf19_2,dingzh1_xf10,dingzh2_ffzmin,dingzh2_ffzmax,dingzh2_ffzmean,dingzh2_xf1_4,dingzh2_xf1_3,dingzh2_xf1_2,dingzh2_xf1,dingzh2_xf3_2,dingzh2_xf2,dingzh2_xf5_2,dingzh2_xf3,dingzh2_xf7_2,dingzh2_xf4,dingzh2_xf9_2,dingzh2_xf5,dingzh2_xf11_2,dingzh2_xf6,dingzh2_xf13_2,dingzh2_xf7,dingzh2_xf15_2,dingzh2_xf8,dingzh2_xf17_2,dingzh2_xf9,dingzh2_xf19_2,dingzh2_xf10,dingzh3_ffzmin,dingzh3_ffzmax,dingzh3_ffzmean,dingzh3_xf1_4,dingzh3_xf1_3,dingzh3_xf1_2,dingzh3_xf1,dingzh3_xf3_2,dingzh3_xf2,dingzh3_xf5_2,dingzh3_xf3,dingzh3_xf7_2,dingzh3_xf4,dingzh3_xf9_2,dingzh3_xf5,dingzh3_xf11_2,dingzh3_xf6,dingzh3_xf13_2,dingzh3_xf7,dingzh3_xf15_2,dingzh3_xf8,dingzh3_xf17_2,dingzh3_xf9,dingzh3_xf19_2,dingzh3_xf10,dingzv1_ffzmin,dingzv1_ffzmax,dingzv1_ffzmean,dingzv1_xf1_4,dingzv1_xf1_3,dingzv1_xf1_2,dingzv1_xf1,dingzv1_xf3_2,dingzv1_xf2,dingzv1_xf5_2,dingzv1_xf3,dingzv1_xf7_2,dingzv1_xf4,dingzv1_xf9_2,dingzv1_xf5,dingzv1_xf11_2,dingzv1_xf6,dingzv1_xf13_2,dingzv1_xf7,dingzv1_xf15_2,dingzv1_xf8,dingzv1_xf17_2,dingzv1_xf9,dingzv1_xf19_2,dingzv1_xf10,dingzv2_ffzmin,dingzv2_ffzmax,dingzv2_ffzmean,dingzv2_xf1_4,dingzv2_xf1_3,dingzv2_xf1_2,dingzv2_xf1,dingzv2_xf3_2,dingzv2_xf2,dingzv2_xf5_2,dingzv2_xf3,dingzv2_xf7_2,dingzv2_xf4,dingzv2_xf9_2,dingzv2_xf5,dingzv2_xf11_2,dingzv2_xf6,dingzv2_xf13_2,dingzv2_xf7,dingzv2_xf15_2,dingzv2_xf8,dingzv2_xf17_2,dingzv2_xf9,dingzv2_xf19_2,dingzv2_xf10,dingzv3_ffzmin,dingzv3_ffzmax,dingzv3_ffzmean,dingzv3_xf1_4,dingzv3_xf1_3,dingzv3_xf1_2,dingzv3_xf1,dingzv3_xf3_2,dingzv3_xf2,dingzv3_xf5_2,dingzv3_xf3,dingzv3_xf7_2,dingzv3_xf4,dingzv3_xf9_2,dingzv3_xf5,dingzv3_xf11_2,dingzv3_xf6,dingzv3_xf13_2,dingzv3_xf7,dingzv3_xf15_2,dingzv3_xf8,dingzv3_xf17_2,dingzv3_xf9,dingzv3_xf19_2,dingzv3_xf10,ylmddg_ffzmin,ylmddg_ffzmax,ylmddg_ffzmean,ylmddg_xf1_4,ylmddg_xf1_3,ylmddg_xf1_2,ylmddg_xf1,ylmddg_xf3_2,ylmddg_xf2,ylmddg_xf5_2,ylmddg_xf3,ylmddg_xf7_2,ylmddg_xf4,ylmddg_xf9_2,ylmddg_xf5,ylmddg_xf11_2,ylmddg_xf6,ylmddg_xf13_2,ylmddg_xf7,ylmddg_xf15_2,ylmddg_xf8,ylmddg_xf17_2,ylmddg_xf9,ylmddg_xf19_2,ylmddg_xf10,ylmdwy_ffzmin,ylmdwy_ffzmax,ylmdwy_ffzmean,ylmdwy_xf1_4,ylmdwy_xf1_3,ylmdwy_xf1_2,ylmdwy_xf1,ylmdwy_xf3_2,ylmdwy_xf2,ylmdwy_xf5_2,ylmdwy_xf3,ylmdwy_xf7_2,ylmdwy_xf4,ylmdwy_xf9_2,ylmdwy_xf5,ylmdwy_xf11_2,ylmdwy_xf6,ylmdwy_xf13_2,ylmdwy_xf7,ylmdwy_xf15_2,ylmdwy_xf8,ylmdwy_xf17_2,ylmdwy_xf9,ylmdwy_xf19_2,ylmdwy_xf10,ylmdwk_ffzmin,ylmdwk_ffzmax,ylmdwk_ffzmean,ylmdwk_xf1_4,ylmdwk_xf1_3,ylmdwk_xf1_2,ylmdwk_xf1,ylmdwk_xf3_2,ylmdwk_xf2,ylmdwk_xf5_2,ylmdwk_xf3,ylmdwk_xf7_2,ylmdwk_xf4,ylmdwk_xf9_2,ylmdwk_xf5,ylmdwk_xf11_2,ylmdwk_xf6,ylmdwk_xf13_2,ylmdwk_xf7,ylmdwk_xf15_2,ylmdwk_xf8,ylmdwk_xf17_2,ylmdwk_xf9,ylmdwk_xf19_2,ylmdwk_xf10,ylmdshang_ffzmin,ylmdshang_ffzmax,ylmdshang_ffzmean,ylmdshang_xf1_4,ylmdshang_xf1_3,ylmdshang_xf1_2,ylmdshang_xf1,ylmdshang_xf3_2,ylmdshang_xf2,ylmdshang_xf5_2,ylmdshang_xf3,ylmdshang_xf7_2,ylmdshang_xf4,ylmdshang_xf9_2,ylmdshang_xf5,ylmdshang_xf11_2,ylmdshang_xf6,ylmdshang_xf13_2,ylmdshang_xf7,ylmdshang_xf15_2,ylmdshang_xf8,ylmdshang_xf17_2,ylmdshang_xf9,ylmdshang_xf19_2,ylmdshang_xf10,ylmdxia_ffzmin,ylmdxia_ffzmax,ylmdxia_ffzmean,ylmdxia_xf1_4,ylmdxia_xf1_3,ylmdxia_xf1_2,ylmdxia_xf1,ylmdxia_xf3_2,ylmdxia_xf2,ylmdxia_xf5_2,ylmdxia_xf3,ylmdxia_xf7_2,ylmdxia_xf4,ylmdxia_xf9_2,ylmdxia_xf5,ylmdxia_xf11_2,ylmdxia_xf6,ylmdxia_xf13_2,ylmdxia_xf7,ylmdxia_xf15_2,ylmdxia_xf8,ylmdxia_xf17_2,ylmdxia_xf9,ylmdxia_xf19_2,ylmdxia_xf10,wkyc_mvmin,wkyc_mvmax,wkyc_mvmean,bqfs_mvmin,bqfs_mvmax,bqfs_mvmean,active_power_mvmin,active_power_mvmax,active_power_mvmean,reactive_power_mvmin,reactive_power_mvmax,reactive_power_mvmean,vane_open_mvmin,vane_open_mvmax,vane_open_mvmean,backup_mvmin,backup_mvmax,backup_mvmean,waterhead_mvmin,waterhead_mvmax,waterhead_mvmean,exc_current_mvmin,exc_current_mvmax,exc_current_mvmean,exc_voltage_mvmin,exc_voltage_mvmax,exc_voltage_mvmean,zs_mvmin,zs_mvmax,zs_mvmean,flow_mvmin,flow_mvmax,flow_mvmean from hd_middledata_all_xfs_ffz_mean_tmp where y='"+ymdh[:4]+"' and m='"+ymdh[4:6]+"' and d='"+ymdh[6:8]+"';"
    #print si
